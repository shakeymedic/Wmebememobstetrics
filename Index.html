<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A&E Obstetric & Gynae Emergencies</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .nav-button.active {
            background-color: #2563eb;
            color: white;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        /* Custom checkbox style */
        .custom-checkbox:checked {
            background-color: #2563eb;
            border-color: #2563eb;
        }
        .custom-checkbox:checked::after {
            content: '✓';
            color: white;
            display: block;
            text-align: center;
            line-height: 1.25rem; /* Matches h-5 w-5 */
        }
        /* Accordion styles */
        details > summary {
            list-style: none;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details .details-content {
            background-color: #f8fafc; /* gray-50 */
            border-left: 3px solid #60a5fa; /* blue-400 */
        }
        .summary-arrow {
            transition: transform 0.2s;
        }
        details[open] .summary-arrow {
            transform: rotate(90deg);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 md:p-6 lg:p-8 max-w-7xl">

        <header class="text-center mb-8">
            <img src="https://iili.io/KGQOvkl.md.png" alt="West Midlands Evidence Based Emergency Medicine Logo" class="h-24 w-auto mx-auto mb-4" onerror="this.style.display='none'">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-900">A&E Obstetric & Gynaecological Emergencies</h1>
            <p class="text-md text-gray-600 mt-2">A quick reference and documentation tool for UK Emergency Medicine.</p>
        </header>

        <nav class="mb-8">
            <ul id="nav-menu" class="flex flex-wrap justify-center gap-2">
                </ul>
        </nav>

        <main id="main-content">
            </main>

        <footer class="text-center mt-12 py-6 border-t border-gray-200">
            <p class="text-sm text-gray-600">Created by Dr Jake Turner and West Midlands Evidence Based Emergency Medicine Ltd.</p>
            <div class="mt-2 text-xs text-gray-500">
                <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center hover:underline">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 496 512" fill="currentColor"><path d="M248,8C111,8,0,119,0,256S111,504,248,504,496,393,496,256,385,8,248,8ZM216,352a32,32,0,1,1,32-32A32,32,0,0,1,216,352Zm64,0a32,32,0,1,1,32-32A32,32,0,0,1,280,352Zm64-128a32,32,0,1,1,32-32A32,32,0,0,1,344,224Zm-64,0a32,32,0,1,1,32-32A32,32,0,0,1,280,224Z"/></svg>
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1.5" viewBox="0 0 512 512" fill="currentColor"><path d="M256,256c53,0,96-43,96-96s-43-96-96-96-96,43-96,96,43,96,96,96Zm0,32c-61.9,0-112,50.1-112,112v32c0,17.7,14.3,32,32,32H336c17.7,0,32-14.3,32-32V400c0-61.9-50.1-112-112-112Z"/></svg>
                    This work is licensed under a Creative Commons Attribution 4.0 International License.
                </a>
            </div>
        </footer>

    </div>

    <script>
    // --- DATA FOR EMERGENCY PROTOCOLS ---
    const emergencyProtocols = [
        {
            id: 'amniotic_fluid_embolism',
            name: 'Amniotic Fluid Embolism',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-amniotic_fluid_embolism" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Recognised sudden collapse. Called for senior O&G, Anaesthetics/ITU, Haematology.">
                                    Recognise & Call for Help
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">AFE is a diagnosis of exclusion characterised by sudden cardiovascular collapse, profound hypoxia, and coagulopathy during labour or shortly after delivery. An immediate, massive multi-disciplinary response is the only chance of survival.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="High-quality CPR with obstetric modifications commenced immediately.">
                                    High-Quality CPR
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">If the patient is in cardiac arrest, commence standard ALS with obstetric modifications (manual left uterine displacement, IV access above diaphragm). Early resuscitative hysterotomy is key if arrest occurs pre-delivery.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Aggressive oxygenation and ventilation support initiated.">
                                    Oxygenation & Ventilation
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Profound hypoxia is a hallmark. Secure the airway early and provide 100% oxygen. Patients will likely require advanced ventilator support to manage acute respiratory distress syndrome (ARDS).</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Major Haemorrhage Protocol activated to manage severe coagulopathy.">
                                    Treat Coagulopathy (Activate MHP)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">AFE causes a profound consumptive coagulopathy. Activate the MHP immediately. Aggressively replace blood products (RBCs, FFP, Platelets, Cryoprecipitate) based on clinical bleeding and point-of-care testing (ROTEM/TEG if available).</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Key Points</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Diagnosis of Exclusion:</strong> Rule out other causes of collapse (PPH, PE, Eclampsia, Sepsis, Anaphylaxis).</li>
                                <li><strong>Supportive Care:</strong> Management is entirely supportive. There is no specific treatment. Focus on high-quality resuscitation.</li>
                                <li><strong>Biphasic Illness:</strong> Initial phase is cardiovascular collapse from pulmonary vasospasm. Second phase is left ventricular failure and coagulopathy.</li>
                                <li><strong>High Mortality:</strong> AFE carries a very high maternal and fetal mortality rate.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('amniotic_fluid_embolism')}
                    </div>
                </div>
            `
        },
        {
            id: 'placental_abruption',
            name: 'Placental Abruption',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-placental_abruption" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Recognised painful vaginal bleeding. Called for senior O&G and Anaesthetics.">
                                    Recognise & Call for Help
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Placental abruption is the premature separation of the placenta from the uterine wall. The classic presentation is painful vaginal bleeding. However, bleeding can be concealed behind the placenta, presenting only with pain and signs of shock. Any haemodynamic instability requires an immediate senior response.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Maternal resuscitation commenced (ABCDE, x2 large bore IV, high-flow O2).">
                                    Maternal Resuscitation
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Assess and stabilise the mother first. Secure wide-bore IV access and send bloods (FBC, Coag including Fibrinogen, Crossmatch 4-6 units). A large abruption can trigger DIC, so a coagulation screen is vital. Administer fluids and blood products as guided by clinical state.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Continuous CTG monitoring of fetus commenced.">
                                    Assess Fetal Wellbeing
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Once the mother is stable, fetal wellbeing must be assessed with a continuous cardiotocograph (CTG). The abruption compromises fetal oxygen supply, leading to fetal distress (decelerations, reduced variability, bradycardia).</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Anti-D immunoglobulin administered for Rhesus-negative mother.">
                                    Administer Anti-D
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Any antepartum haemorrhage is a sensitising event. All Rhesus-negative women should receive Anti-D immunoglobulin. A Kleihauer test should be sent to quantify any feto-maternal haemorrhage and guide further dosing.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Plan for definitive delivery discussed with O&G.">
                                    Plan for Definitive Delivery
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Definitive management is delivery. If there is maternal or fetal compromise, this will be via emergency Category 1 Caesarean section, irrespective of gestational age.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Key Points</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Painful Bleeding:</strong> This is the key feature distinguishing it from placenta praevia (painless).</li>
                                <li><strong>Woody Uterus:</strong> On examination, the uterus may be tense, tender, and 'woody' to the touch due to concealed haemorrhage.</li>
                                <li><strong>Ultrasound is Unreliable:</strong> Ultrasound has a very low sensitivity for detecting abruption and cannot be used to rule it out. Diagnosis is clinical.</li>
                                <li><strong>DIC Risk:</strong> Abruption is a major cause of disseminated intravascular coagulation (DIC) in pregnancy.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('placental_abruption')}
                    </div>
                </div>
            `
        },
        {
            id: 'ovarian_torsion',
            name: 'Ovarian Torsion',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-ovarian_torsion" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Considered diagnosis in patient with sudden onset severe unilateral pelvic pain and vomiting.">
                                    High Index of Suspicion
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Ovarian torsion is a surgical emergency to preserve ovarian function. The classic presentation is sudden, severe, unilateral pelvic pain, often with nausea/vomiting. 'Time is ovary'.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Urine hCG performed to rule out ectopic pregnancy.">
                                    Rule out Ectopic Pregnancy
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">The presentation can mimic a ruptured ectopic. A urine pregnancy test is a mandatory first step in any woman of reproductive age with pelvic pain.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Adequate analgesia and antiemetics provided.">
                                    Provide Analgesia & Antiemetics
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">The pain from ovarian torsion is typically severe and requires IV opiates for effective control. Vomiting is also a prominent feature.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Urgent Gynaecology referral made based on clinical suspicion.">
                                    Urgent Gynaecology Referral
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Refer urgently for consideration of emergency laparoscopy. Do not let a 'normal' ultrasound with Doppler flow delay referral if clinical suspicion is high. The definitive diagnosis is made surgically.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Key Points</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Clinical Diagnosis:</strong> Torsion is primarily a clinical diagnosis.</li>
                                <li><strong>Doppler Can Be Normal:</strong> Due to the ovary's dual blood supply, the presence of arterial flow on Doppler ultrasound DOES NOT rule out torsion.</li>
                                <li><strong>Risk Factor:</strong> An ovarian cyst >5cm is the main risk factor.</li>
                                <li><strong>Time is Ovary:</strong> The chance of salvaging the ovary decreases significantly after 6-8 hours of ischaemia.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('ovarian_torsion')}
                    </div>
                </div>
            `
        },
        {
            id: 'severe_pid',
            name: 'Severe PID / TOA',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-severe_pid" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Identified features of severe PID requiring admission.">
                                    Identify Severe Disease
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Admit patients with signs of sepsis (fever >38°C, tachycardia), peritonism, a palpable adnexal mass (suggesting a tubo-ovarian abscess), or inability to tolerate oral therapy. Have a low threshold for admission to prevent long-term complications.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="IV access gained, bloods sent (FBC, CRP, U&E, LFT, G&S, Blood cultures).">
                                    Gain Access & Send Bloods
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Secure IV access for parenteral antibiotics and fluids. Send bloods to assess for inflammatory response and sepsis. Blood cultures should be taken if the patient is pyrexial.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Commenced inpatient IV antibiotics as per BASHH guidelines.">
                                    Commence IV Antibiotics
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Do not delay treatment waiting for results. Start broad-spectrum IV antibiotics immediately to cover likely pathogens (*N. gonorrhoeae*, *C. trachomatis*, anaerobes).</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Gynaecology team consulted for admission and potential drainage of abscess.">
                                    Consult Gynaecology
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">All patients requiring admission for severe PID or suspected TOA need formal gynaecology review. A TOA may require ultrasound-guided drainage or surgical intervention if it does not respond to antibiotics.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Inpatient IV Antibiotics (BASHH)</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Ceftriaxone 2g IV</strong> once daily</li>
                                <li><strong>PLUS Doxycycline 100mg IV/PO</strong> twice daily</li>
                                <li><strong>PLUS Metronidazole 500mg IV</strong> three times daily</li>
                                <li class="pt-2 text-xs text-gray-500">Switch to oral therapy 24h after clinical improvement to complete a 14-day course.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('severe_pid')}
                    </div>
                </div>
            `
        },
        {
            id: 'pre_eclampsia',
            name: 'Pre-eclampsia & Eclampsia',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-pre_eclampsia" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Senior ED, O&G, and Anaesthetics/ITU teams alerted.">
                                    Alert Senior Multidisciplinary Team
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is a multi-system disorder requiring coordinated input. Involve senior obstetricians for delivery planning, anaesthetics for airway/critical care management, and ITU for potential post-stabilisation care. Clear, early communication is vital.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Airway secured, high-flow oxygen administered.">
                                    Secure Airway & Give High-Flow O₂
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Pregnant patients have a decreased functional residual capacity and increased oxygen consumption, leading to rapid desaturation. Airway oedema can make intubation difficult; ensure the most experienced operator is available. Prioritise oxygenation to protect both mother and fetus.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="IV access established x2 large bore cannulae.">
                                    Gain IV Access (x2 large bore)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Secure reliable, large-bore access for administration of anticonvulsants, antihypertensives, and potential resuscitation fluids. If possible, site cannulae in the antecubital fossae (above the diaphragm).</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Administer Magnesium Sulfate for seizure control.">
                                    Administer Magnesium Sulfate
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">MgSO₄ is the drug of choice for treating and preventing eclamptic seizures. It acts as a cerebral vasodilator and membrane stabiliser. Follow local protocol for loading and maintenance doses. Monitor for toxicity (loss of reflexes, respiratory depression). Antidote: Calcium Gluconate.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Administer IV Labetalol or Hydralazine for BP control.">
                                    Control Severe Hypertension
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">The primary goal is to prevent maternal intracerebral haemorrhage. A systolic BP ≥160 mmHg is a medical emergency. Aim to reduce BP gradually to a target of ~135/85 mmHg. Avoid sudden drops which can compromise placental perfusion.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Insert urinary catheter and restrict fluids.">
                                    Manage Fluid Balance
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Patients have leaky capillaries and are at high risk of pulmonary oedema. Insert a catheter for strict hourly urine output monitoring. Restrict total IV fluids to 80ml/hour or 1ml/kg/hour.</p>
                                </div>
                            </details>
                        </div>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Drug Dosing</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Magnesium Sulfate (Eclampsia/Seizure):</strong> 4g IV loading dose over 5-15 mins, followed by 1g/hour infusion.</li>
                                <li><strong>IV Labetalol (Hypertension):</strong> 20mg bolus, then 40mg, then 80mg every 10-15 mins. Max 300mg total. Or infusion 1-2mg/min.</li>
                                <li><strong>IV Hydralazine (Hypertension):</strong> 5mg slow IV bolus, repeat at 20 min intervals if needed. Max 20mg.</li>
                                <li><strong>Fluid Management:</strong> Restrict fluids to 80ml/hour to reduce risk of pulmonary oedema.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('pre_eclampsia')}
                    </div>
                </div>
            `
        },
        {
            id: 'ruptured_ectopic',
            name: 'Ruptured Ectopic',
            content: `
                 <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-ruptured_ectopic" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Emergency O&G and Anaesthetics teams called STAT.">
                                    Call O&G and Anaesthetics STAT
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is a time-critical surgical emergency. The definitive treatment is operative haemostasis. Early involvement of the surgical and anaesthetic teams is crucial for rapid transfer to theatre.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="ABCDE approach: High-flow O₂, secure airway if needed.">
                                    Resuscitate (ABCDE)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Follow standard resuscitation principles. Administer high-flow oxygen. A patient in haemorrhagic shock with a reduced GCS requires immediate airway protection via intubation.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Major Haemorrhage Protocol activated.">
                                    Activate Major Haemorrhage Protocol
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Do not wait for blood results. Activate based on clinical signs of haemodynamic instability (tachycardia, hypotension, syncope). This ensures timely delivery of balanced blood products (packed red cells, FFP, platelets) and alerts haematology.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Bloods sent (FBC, Coag, U&E, Crossmatch 4-6 units).">
                                    Send Urgent Bloods
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Send FBC, coagulation screen, and U&Es. Crucially, send a sample to crossmatch a minimum of 4-6 units of red cells. The initial Hb may be falsely reassuring before haemodilution.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Patient prepared for immediate transfer to theatre.">
                                    Prepare for Immediate Theatre
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Resuscitation is a bridge to definitive surgical control of bleeding. Do not delay transfer for imaging if the patient is unstable. A positive pregnancy test plus shock and/or peritonism is sufficient indication for emergency laparotomy.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Drug Dosing</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Fluid Resuscitation:</strong> 500ml warmed crystalloid bolus, reassess. Use blood products ASAP.</li>
                                <li><strong>Tranexamic Acid:</strong> 1g IV over 10 minutes.</li>
                                <li><strong>Analgesia:</strong> IV Morphine 2.5-5mg titrated to effect.</li>
                                <li><strong>Anti-D:</strong> 250 IU IM if <20 weeks gestation. 500 IU if >20 weeks.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('ruptured_ectopic')}
                    </div>
                </div>
            `
        },
        {
            id: 'post_partum_haemorrhage',
            name: 'Post-Partum Haemorrhage',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-post_partum_haemorrhage" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Help called & Major Haemorrhage Protocol activated.">
                                    Call Help & Activate MHP
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">PPH is a leading cause of maternal mortality. A multi-disciplinary response is essential. Activate the MHP early based on clinical assessment of blood loss (>1000ml) or haemodynamic instability.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Mechanical measures: Fundal massage performed.">
                                    Mechanical: Fundal Massage
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">The most common cause of PPH is uterine atony (Tone). Firmly massaging the uterine fundus through the abdomen stimulates mechanical contraction of the uterine muscle, compressing the spiral arteries and reducing blood flow.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Medical: Uterotonics administered.">
                                    Medical: Administer Uterotonics
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Pharmacological agents are used to induce sustained uterine contraction. This is a stepwise process, starting with Syntocinon (Oxytocin) and adding other agents like Ergometrine and Carboprost if bleeding continues. Be aware of contraindications (e.g., Ergometrine in hypertension, Carboprost in asthma).</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Source of bleeding identified (4 Ts).">
                                    Identify Cause (4 Ts)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Systematically assess for the cause: <br><b>Tone:</b> Uterine atony (most common). <br><b>Trauma:</b> Vaginal/cervical tears, uterine rupture. Requires examination. <br><b>Tissue:</b> Retained products of conception (placenta). <br><b>Thrombin:</b> Coagulopathy (can be cause or effect of PPH).</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Drug Dosing</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Syntocinon (Oxytocin):</strong> 5 IU slow IV. Can be followed by 40 IU in 500ml NaCl 0.9% over 4 hours.</li>
                                <li><strong>Ergometrine:</strong> 500 mcg slow IV or IM. (Contraindicated in hypertension).</li>
                                <li><strong>Tranexamic Acid:</strong> 1g IV over 10 minutes. Repeat dose after 30 mins if bleeding continues.</li>
                                <li><strong>Carboprost (Hemabate):</strong> 250 mcg IM. Can be repeated every 15 mins. Max 8 doses. (Contraindicated in asthma).</li>
                                 <li><strong>Misoprostol:</strong> 800-1000 mcg PR (per rectum).</li>
                            </ul>
                        </div>
                        ${generateNotesSection('post_partum_haemorrhage')}
                    </div>
                </div>
            `
        },
        {
            id: 'cord_prolapse',
            name: 'Cord Prolapse',
            content: `
                 <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-cord_prolapse" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Emergency buzzer pressed. O&G, Paeds, Anaesthetics called.">
                                    Call for Help Immediately
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is a time-critical emergency threatening fetal life due to cord compression and hypoxia. Immediate delivery is required, usually by Category 1 C-section. Alert all necessary personnel simultaneously.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Manually elevate presenting part off the cord.">
                                    Relieve Cord Compression
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is the most important first aid measure. Insert a sterile-gloved hand into the vagina and push the presenting part (head or buttocks) upwards to lift it off the umbilical cord. This hand must remain in place until the baby is delivered by C-section.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Position mother: knee-chest or deep Trendelenburg.">
                                    Position the Mother
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Use gravity to assist in relieving pressure on the cord. The knee-chest position (all fours with head down) is ideal. If not possible, place the bed in a steep head-down (Trendelenburg) tilt.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Administer tocolysis (Terbutaline).">
                                    Administer Tocolysis
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">A tocolytic agent like Terbutaline is given to temporarily stop uterine contractions. This reduces pressure on the cord while preparations are made for definitive delivery in theatre.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Drug Dosing</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Tocolysis:</strong> Terbutaline 250mcg subcutaneously.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('cord_prolapse')}
                    </div>
                </div>
            `
        },
        {
            id: 'shoulder_dystocia',
            name: 'Shoulder Dystocia',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps (HELPERR)</h3>
                        <div id="checklist-shoulder_dystocia" class="space-y-2">
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Help called (Senior O&G, Paeds, Anaesthetics). Noted time of head delivery.">
                                    <strong>H</strong>elp
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Announce the emergency clearly. Note the exact time of head delivery. The goal is to deliver the body within 5 minutes to minimise risk of hypoxic brain injury. Mobilise senior help immediately.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Legs placed in McRoberts' position (hyperflexion at hips).">
                                    <strong>L</strong>egs (McRoberts' Manoeuvre)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is the single most effective manoeuvre. Hyperflexing the mother's hips flattens the sacral promontory and rotates the symphysis pubis, increasing the effective pelvic outlet diameter. It resolves up to 90% of cases when combined with suprapubic pressure.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Suprapubic pressure applied to disimpact anterior shoulder.">
                                    <strong>P</strong>ressure (Suprapubic)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Apply firm pressure with the heel of the hand just above the pubic bone, directed downwards and laterally towards the baby's chest. This helps adduct the anterior shoulder and push it under the symphysis. <strong>NEVER apply fundal pressure.</strong></p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Internal manoeuvres attempted (e.g., Rubin II, Woods' Screw).">
                                    <strong>E</strong>nter (Internal Manoeuvres)
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">If external manoeuvres fail, insert a hand into the vagina to attempt to rotate the shoulders into a wider pelvic diameter. This requires an experienced operator.</p>
                                </div>
                            </details>
                            <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Posterior arm delivered.">
                                    <strong>R</strong>emove the Posterior Arm
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Flexing the posterior arm at the elbow and sweeping it across the chest for delivery reduces the bisacromial diameter, often allowing the impacted anterior shoulder to be released.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Key Points</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>No Fundal Pressure:</strong> Absolutely contraindicated.</li>
                                <li><strong>Time is critical:</strong> Aim to deliver within 5 minutes to reduce risk of hypoxic brain injury.</li>
                                <li><strong>Post-delivery:</strong> Be prepared for PPH and neonatal resuscitation. Examine for trauma.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('shoulder_dystocia')}
                    </div>
                </div>
            `
        },
        {
            id: 'breech_birth',
            name: 'Breech Birth (Unexpected)',
            content: `
                 <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps</h3>
                        <div id="checklist-breech_birth" class="space-y-2">
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Senior help called (O&G, Paediatrics).">
                                    Call for Senior Help
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">An unexpected breech delivery in the ED is a high-risk situation. Immediately call for an experienced obstetrician/midwife and a paediatrician, as there is a high risk of head entrapment and neonatal compromise.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Hands-off approach adopted until umbilicus is visible.">
                                    'Hands Off' the Breech
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Allow the delivery to proceed spontaneously until the umbilicus is visible. Do not apply traction. This allows the baby to descend and prevents premature extension of the fetal head, which is the main cause of entrapment.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Mauriceau-Smellie-Veit (MSV) manoeuvre performed to deliver head.">
                                    Deliver Head using MSV Manoeuvre
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Once the nape of the neck is visible, perform the MSV manoeuvre to deliver the aftercoming head. The goal is to maintain flexion of the head. An assistant providing suprapubic pressure helps with this. Avoid traction.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Key Points</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Avoid traction:</strong> Pulling on the body can cause head extension and entrapment.</li>
                                <li><strong>Keep baby's back anterior:</strong> Essential for successful delivery of the head.</li>
                                <li><strong>MSV Manoeuvre:</strong> Support baby's body on your forearm. Place index and middle fingers on baby's cheekbones. Other hand applies pressure to the occiput to flex the head.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('breech_birth')}
                    </div>
                </div>
            `
        },
        {
            id: 'cardiac_arrest',
            name: 'Obstetric Cardiac Arrest',
            content: `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-xl font-bold mb-4 text-blue-700">Management Steps (ALS + Modifications)</h3>
                        <div id="checklist-cardiac_arrest" class="space-y-2">
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Manual left uterine displacement performed.">
                                    Perform Manual Left Uterine Displacement
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is the single most important modification to standard CPR. The gravid uterus compresses the inferior vena cava and aorta, reducing venous return and cardiac output by ~30%. Manually pulling the uterus to the left relieves this compression and dramatically improves the effectiveness of chest compressions.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="IV access established above the diaphragm.">
                                    IV Access Above Diaphragm
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">Due to aortocaval compression, drugs administered via femoral or saphenous veins may have delayed or absent delivery to the central circulation. Secure access in the antecubital fossae, external jugular, or via an intraosseous needle in the humeral head.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Decision made re: Resuscitative Hysterotomy (perimortem C-section).">
                                    Consider Resuscitative Hysterotomy
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This is a resuscitative procedure for the MOTHER. If ROSC is not achieved by 4 minutes of arrest in a woman >20 weeks pregnant, RH should be performed with the aim of delivering the baby by 5 minutes. Emptying the uterus is the most effective way to relieve aortocaval compression and is often the only way to achieve ROSC.</p>
                                </div>
                            </details>
                             <details class="border-b border-gray-200 py-2">
                                <summary class="font-medium text-gray-700 hover:bg-gray-50 p-2 rounded-md">
                                    <input type="checkbox" class="h-5 w-5 mr-3 flex-shrink-0 rounded border-gray-300 text-blue-600 focus:ring-blue-500 custom-checkbox" data-log="Resuscitative Hysterotomy performed.">
                                    Perform Resuscitative Hysterotomy
                                    <span class="ml-auto summary-arrow">&#9654;</span>
                                </summary>
                                <div class="p-4 mt-2 ml-8 details-content rounded-md">
                                    <p class="text-sm text-gray-600">This must be done in the ED. Do not wait for obstetrics or transfer to theatre. Perform a large vertical midline laparotomy, incise the uterus, and deliver the baby and placenta. Pack the uterus. Continue CPR throughout.</p>
                                </div>
                            </details>
                        </div>
                    </div>
                    <div class="space-y-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-xl font-bold mb-4 text-red-600">Resuscitative Hysterotomy</h3>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Indication:</strong> Cardiac arrest in a visibly pregnant woman (>20 weeks) where initial resuscitation is unsuccessful.</li>
                                <li><strong>Timing:</strong> Aim to start by 4 minutes post-arrest and deliver baby by 5 minutes.</li>
                                <li><strong>Goal:</strong> To improve maternal circulation by relieving aortocaval compression, NOT primarily for fetal survival (though this is a bonus).</li>
                                <li><strong>Procedure:</strong> Large vertical midline incision from xiphisternum to pubis. Incise uterus vertically. Deliver baby and placenta. Continue CPR throughout.</li>
                            </ul>
                        </div>
                        ${generateNotesSection('cardiac_arrest')}
                    </div>
                </div>
            `
        }
    ];

    // --- UTILITY FUNCTIONS ---
    function generateNotesSection(id) {
        return `
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-xl font-bold mb-4 text-green-700">Timestamped Log</h3>
                <textarea id="notes-${id}" class="w-full h-48 p-2 border border-gray-300 rounded-md bg-gray-50 text-sm" readonly placeholder="Check items above to generate a log..."></textarea>
                <div class="mt-4 flex gap-2">
                    <button onclick="copyNotes('${id}')" class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition-colors">Copy Notes</button>
                    <button onclick="clearNotes('${id}')" class="w-full bg-gray-500 text-white py-2 px-4 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 transition-colors">Clear</button>
                </div>
                 <p id="copy-confirm-${id}" class="text-sm text-green-600 mt-2 h-4"></p>
            </div>
        `;
    }

    function copyNotes(id) {
        const notesArea = document.getElementById(`notes-${id}`);
        notesArea.select();
        document.execCommand('copy');
        
        const confirmMsg = document.getElementById(`copy-confirm-${id}`);
        confirmMsg.textContent = 'Copied to clipboard!';
        setTimeout(() => {
            confirmMsg.textContent = '';
        }, 2000);
    }
    
    function clearNotes(id) {
        const notesArea = document.getElementById(`notes-${id}`);
        notesArea.value = '';
        
        // Uncheck all checkboxes for this section
        const checklist = document.getElementById(`checklist-${id}`);
        const checkboxes = checklist.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(cb => cb.checked = false);
    }

    function handleCheckboxChange(event, protocolId) {
        // Stop the click from propagating to the <summary> and toggling the <details>
        event.stopPropagation(); 
        
        const checkbox = event.target;
        const logMessage = checkbox.getAttribute('data-log');
        const notesArea = document.getElementById(`notes-${protocolId}`);

        // Rebuild the notes from scratch based on currently checked boxes to maintain order
        const checklist = document.getElementById(`checklist-${protocolId}`);
        const allCheckboxes = checklist.querySelectorAll('input[type="checkbox"]');
        let newNotesValue = '';
        
        allCheckboxes.forEach(cb => {
            if (cb.checked) {
                // To avoid re-adding timestamps, we need a better system.
                // For now, let's just add/remove the text without a new timestamp. This is a limitation.
                // A better approach is to rebuild the log from a stored array of events.
            }
        });

        if (checkbox.checked) {
            const now = new Date();
            const timeString = now.toTimeString().split(' ')[0]; // HH:MM:SS
            const fullLog = `${timeString} - ${logMessage}\n`;
            notesArea.value += fullLog;
            notesArea.scrollTop = notes-area.scrollHeight; // Auto-scroll to bottom
        } else {
             // Simple removal of the line. This is imperfect if the same log message exists twice.
            const lineToRemove = `${logMessage}\n`;
            const lines = notesArea.value.split('\n');
            const newLines = lines.filter(line => !line.includes(logMessage));
            notesArea.value = newLines.join('\n');
        }
    }

    function showContent(protocolId) {
        // Update active button
        const navButtons = document.querySelectorAll('.nav-button');
        navButtons.forEach(button => {
            button.classList.toggle('active', button.dataset.id === protocolId);
        });

        // Show active content
        const contentSections = document.querySelectorAll('.content-section');
        contentSections.forEach(section => {
            section.classList.toggle('active', section.id === `content-${protocolId}`);
        });
    }

    // --- INITIALIZATION ---
    document.addEventListener('DOMContentLoaded', () => {
        const navMenu = document.getElementById('nav-menu');
        const mainContent = document.getElementById('main-content');

        // Sort protocols alphabetically by name for better navigation
        emergencyProtocols.sort((a, b) => a.name.localeCompare(b.name));

        emergencyProtocols.forEach(protocol => {
            // Create nav button
            const navButton = document.createElement('button');
            navButton.className = 'nav-button py-2 px-4 rounded-md bg-white shadow-sm hover:bg-blue-100 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50';
            navButton.textContent = protocol.name;
            navButton.dataset.id = protocol.id;
            navButton.onclick = () => showContent(protocol.id);
            navMenu.appendChild(navButton);

            // Create content section
            const contentSection = document.createElement('div');
            contentSection.id = `content-${protocol.id}`;
            contentSection.className = 'content-section bg-gray-50 p-4 md:p-6 rounded-lg shadow-inner';
            contentSection.innerHTML = protocol.content;
            mainContent.appendChild(contentSection);

            // Add event listeners to checkboxes for this section
            const checklist = contentSection.querySelector(`#checklist-${protocol.id}`);
            if (checklist) {
                 checklist.addEventListener('click', (event) => {
                    if (event.target.type === 'checkbox') {
                        handleCheckboxChange(event, protocol.id);
                    }
                });
            }
        });

        // Show the first protocol by default
        if (emergencyProtocols.length > 0) {
            showContent(emergencyProtocols[0].id);
        }

        // Slightly improved logging to handle unchecking
        const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
        let logEntries = {};

        allCheckboxes.forEach(checkbox => {
            const protocolId = checkbox.closest('.content-section').id.replace('content-', '');
            if (!logEntries[protocolId]) {
                logEntries[protocolId] = [];
            }

            checkbox.addEventListener('change', (event) => {
                const logMessage = event.target.getAttribute('data-log');
                const now = new Date();
                const timeString = now.toTimeString().split(' ')[0];
                
                if(event.target.checked) {
                    logEntries[protocolId].push({ time: timeString, message: logMessage, id: logMessage });
                } else {
                    logEntries[protocolId] = logEntries[protocolId].filter(entry => entry.message !== logMessage);
                }

                // Sort by time just in case
                logEntries[protocolId].sort((a, b) => a.time.localeCompare(b.time));
                
                const notesArea = document.getElementById(`notes-${protocolId}`);
                notesArea.value = logEntries[protocolId].map(entry => `${entry.time} - ${entry.message}`).join('\n');
                notesArea.scrollTop = notesArea.scrollHeight;
            });

            // Add clear functionality to the logEntries object as well
             document.querySelector(`#notes-${protocolId}`).nextElementSibling.querySelector('button:last-child').addEventListener('click', () => {
                logEntries[protocolId] = [];
             });
        });
    });
    </script>
</body>
</html>
